<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>ì¹˜ì´ì¹´ì™€ Â· ì„¤ë ˜</title>
    <style>
      :root {
        color-scheme: light;
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        min-height: 100svh;
        display: grid;
        place-items: center;
        background: linear-gradient(180deg, #fce7f3 0%, #f9a8d4 100%);
        font-family: ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto,
          'Noto Sans KR', sans-serif;
        color: #4b5563;
      }
      .card {
        width: min(760px, 92vw);
        background: rgba(255, 255, 255, 0.88);
        border: 1px solid rgba(0, 0, 0, 0.06);
        border-radius: 26px;
        padding: 24px;
        text-align: center;
        position: relative;
        box-shadow: 0 20px 40px rgba(219, 39, 119, 0.18),
          0 4px 14px rgba(0, 0, 0, 0.06);
        overflow: hidden;
      }
      h1 {
        margin: 0 0 8px;
        font-weight: 900;
        color: #db2777;
        letter-spacing: -0.02em;
      }
      p {
        margin: 0 0 14px;
      }

      /* í”„ë ˆì„ */
      .frame-wrap {
        margin-top: 4px;
      }
      .frame {
        position: relative;
        overflow: hidden;
        border-radius: 20px;
        border: 1px solid rgba(0, 0, 0, 0.06);
        background: #fff;
        box-shadow: 0 0 26px rgba(219, 39, 119, 0.2) inset;
        isolation: isolate;
      }
      /* ì€ì€í•œ ë°˜ì§ í…Œë‘ë¦¬ */
      .frame::before {
        content: '';
        position: absolute;
        inset: -2px;
        border-radius: 22px;
        z-index: 0;
        background: conic-gradient(
          from 0deg,
          #f472b6,
          #a78bfa,
          #facc15,
          #22d3ee,
          #f472b6
        );
        filter: blur(10px);
        opacity: 0.28;
        animation: ring 9s linear infinite;
        mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        padding: 2px;
        pointer-events: none;
      }
      @keyframes ring {
        to {
          transform: rotate(1turn);
        }
      }

      /* ìŠ¤í¬íŠ¸ë¼ì´íŠ¸ */
      .spot {
        position: absolute;
        inset: -10% -5%;
        z-index: 0;
        pointer-events: none;
        background: radial-gradient(
          55% 55% at var(--mx, 50%) var(--my, 45%),
          rgba(255, 255, 255, 0.35),
          transparent 60%
        );
        mix-blend-mode: screen;
        transition: background-position 0.08s ease;
      }

      .img {
        position: relative;
        z-index: 1;
        display: block;
        width: 100%;
        height: auto;
      }

      /* ìë§‰(ìº¡ì…˜) */
      .subtitle {
        position: absolute;
        left: 12px;
        bottom: 12px;
        z-index: 2;
        background: rgba(255, 255, 255, 0.88);
        color: #db2777;
        font-weight: 800;
        font-size: 0.98rem;
        letter-spacing: -0.01em;
        border: 1px solid rgba(0, 0, 0, 0.06);
        border-radius: 999px;
        padding: 8px 12px;
        box-shadow: 0 6px 14px rgba(219, 39, 119, 0.18);
        user-select: none;
      }

      /* ëª¨ì…˜ ìµœì†Œí™” */
      @media (prefers-reduced-motion: reduce) {
        .frame::before {
          animation: none !important;
        }
      }

      /* ì»¨íŠ¸ë¡¤ */
      .controls {
        margin-top: 14px;
        display: grid;
        gap: 10px;
        justify-items: center;
      }
      .rows {
        display: flex;
        gap: 10px;
        justify-content: center;
        flex-wrap: wrap;
      }
      button,
      .chip {
        appearance: none;
        border: 0;
        color: #fff;
        background: #ec4899;
        border-radius: 999px;
        padding: 10px 16px;
        cursor: pointer;
        transition: transform 0.05s ease, background 0.2s ease;
        font-weight: 800;
      }
      button:hover,
      .chip:hover {
        background: #db2777;
      }
      button:active,
      .chip:active {
        transform: translateY(1px);
      }
      .chip {
        background: rgba(236, 72, 153, 0.18);
        color: #db2777;
        border: 1px solid rgba(219, 39, 119, 0.35);
      }
      #status {
        font-size: 0.95rem;
        opacity: 0.9;
        color: #6b7280;
      }
      input[type='range'] {
        width: min(420px, 72vw);
        accent-color: #ec4899;
      }

      .footer {
        opacity: 0.9;
        font-size: 0.9rem;
        margin-top: 4px;
        color: #6b7280;
      }
    </style>
  </head>
  <body>
    <main class="card" id="root">
      <h1>ã¡ã„ã‹ã‚ã®ãƒ‰ã‚­ãƒ‰ã‚­ãªä¸€æ—¥ ğŸŒ¸</h1>

      <div class="frame-wrap">
        <div class="frame" id="frame" aria-label="ì„¤ë ˆëŠ” ì¹˜ì´ì¹´ì™€ ì´ë¯¸ì§€">
          <div class="spot" aria-hidden="true"></div>

          <!-- ë©”ì¸ ì´ë¯¸ì§€ -->
          <img
            class="img"
            src="./assets/seollem.gif"
            alt="ã¡ã„ã‹ã‚ã®ãƒ‰ã‚­ãƒ‰ã‚­ãªä¸€æ—¥"
            onerror="this.onerror=null; this.src='assets/seollem.jpg'; this.onerror=function(){ this.src='assets/seollem.png'; };"
          />

          <!-- ìë§‰(ìˆœí™˜) -->
          <span class="subtitle" id="subtitle" aria-live="polite"
            >ä»Šæ—¥ã‚‚ã¨ãã‚ãä¸€æ—¥ã«ãªã‚‹ã‚ˆï¼</span
          >
        </div>
      </div>

      <div class="controls" role="group" aria-label="ì˜¤ë””ì˜¤ ë° íš¨ê³¼ ì œì–´">
        <div class="rows">
          <button id="play" aria-label="ë°°ê²½ìŒì•… ì¬ìƒ">â–¶ ìŒì•… ì¼œê¸°</button>
          <button id="pause" aria-label="ë°°ê²½ìŒì•… ì¼ì‹œì •ì§€">â¸ ì¼ì‹œì •ì§€</button>
        </div>

        <input
          id="seek"
          type="range"
          min="0"
          max="1000"
          value="0"
          aria-label="ì¬ìƒ ìœ„ì¹˜"
        />
        <div class="rows">
          <label class="chip" style="padding: 8px 12px">
            ğŸ”Š ë³¼ë¥¨
            <input
              id="vol"
              type="range"
              min="0"
              max="1"
              step="0.01"
              value="0.8"
              style="vertical-align: middle; width: 160px; margin-left: 8px"
            />
          </label>
          <span id="status">ì •ì§€ë¨</span>
        </div>
        <div class="footer">
          ë‹¨ì¶•í‚¤: Space(ì¬ìƒ/ì¼ì‹œì •ì§€), â†/â†’(5ì´ˆ ì´ë™), â†‘/â†“(ë³¼ë¥¨)
        </div>
      </div>

      <audio id="bgm" preload="auto" loop>
        <source src="./assets/seollem.mp3" type="audio/mpeg" />
        <source src="assets/seollem.m4a" type="audio/mp4" />
        <source src="assets/seollem.ogg" type="audio/ogg" />
      </audio>
    </main>

    <script>
      // ===== ì—˜ë¦¬ë¨¼íŠ¸ =====
      const audio = document.getElementById('bgm')
      const statusEl = document.getElementById('status')
      const seek = document.getElementById('seek')
      const vol = document.getElementById('vol')
      const playBtn = document.getElementById('play')
      const pauseBtn = document.getElementById('pause')
      const subtitle = document.getElementById('subtitle')
      const frame = document.getElementById('frame')
      const spot = document.querySelector('.spot')

      // ===== ìƒíƒœ ë³µì› =====
      const saved = JSON.parse(localStorage.getItem('seollem:state') || '{}')
      audio.volume = saved.volume ?? 0.8
      vol.value = audio.volume
      let captionIndex = saved.captionIndex ?? 0

      // ===== ì˜¤ë””ì˜¤ ì œì–´ =====
      const updateStatus = (txt) => (statusEl.textContent = txt)

      playBtn.addEventListener('click', async () => {
        try {
          await audio.play()
          updateStatus('ì¬ìƒ ì¤‘')
        } catch {
          updateStatus('ì¬ìƒ ì‹¤íŒ¨(ì²« ìƒí˜¸ì‘ìš© í•„ìš”/íŒŒì¼ ì—†ìŒ)')
        }
      })
      pauseBtn.addEventListener('click', () => {
        audio.pause()
        updateStatus('ì¼ì‹œì •ì§€')
      })

      document.addEventListener(
        'pointerdown',
        async () => {
          if (audio.paused) {
            try {
              await audio.play()
              updateStatus('ì¬ìƒ ì¤‘')
            } catch {}
          }
        },
        { once: true }
      )

      vol.addEventListener('input', () => {
        audio.volume = Number(vol.value)
        persist()
      })

      audio.addEventListener('timeupdate', () => {
        if (audio.duration)
          seek.value = Math.floor((audio.currentTime / audio.duration) * 1000)
      })
      seek.addEventListener('input', () => {
        if (audio.duration)
          audio.currentTime = (seek.value / 1000) * audio.duration
      })

      // ===== ë‹¨ì¶•í‚¤ =====
      document.addEventListener('keydown', (e) => {
        if (
          ['INPUT', 'TEXTAREA', 'SELECT'].includes(
            document.activeElement.tagName
          )
        )
          return
        if (e.code === 'Space') {
          e.preventDefault()
          audio.paused ? audio.play() : audio.pause()
        }
        if (e.code === 'ArrowLeft')
          audio.currentTime = Math.max(0, audio.currentTime - 5)
        if (e.code === 'ArrowRight')
          audio.currentTime = Math.min(
            audio.duration || 0,
            audio.currentTime + 5
          )
        if (e.code === 'ArrowUp') {
          audio.volume = Math.min(1, audio.volume + 0.05)
          vol.value = audio.volume
          persist()
        }
        if (e.code === 'ArrowDown') {
          audio.volume = Math.max(0, audio.volume - 0.05)
          vol.value = audio.volume
          persist()
        }
      })

      // ===== ìŠ¤í¬íŠ¸ë¼ì´íŠ¸(ë§ˆìš°ìŠ¤) =====
      frame.addEventListener('pointermove', (e) => {
        const rect = frame.getBoundingClientRect()
        const x = ((e.clientX - rect.left) / rect.width) * 100
        const y = ((e.clientY - rect.top) / rect.height) * 100
        spot.style.setProperty('--mx', x + '%')
        spot.style.setProperty('--my', y + '%')
      })

      // ===== ìë§‰ ë¡œí…Œì´ì…˜ =====
      const lines = [
        'ä»Šæ—¥ã‚‚ã¨ãã‚ãä¸€æ—¥ã«ãªã‚‹ã‚ˆï¼',
        'å°ã•ãªä¸€æ­©ã€ã‚„ã•ã—ã„ãƒˆã‚­ãƒ¡ã‚­ âœ¨',
        'ì˜¤ëŠ˜ë„ ì„¤ë ˆëŠ” í•˜ë£¨ê°€ ë  ê±°ì•¼! ğŸŒ¸',
        'ë§ˆìŒì´ ë§í•´ì¤˜, ê´œì°®ë‹¤ê³ . ğŸ’—',
        'è‡ªåˆ†ã‚’ä¿¡ã˜ã¦ã€ã™ã“ã—ãšã¤ã€‚',
      ]
      function rotateSubtitle() {
        captionIndex = (captionIndex + 1) % lines.length
        subtitle.textContent = lines[captionIndex]
        persist()
      }
      setInterval(rotateSubtitle, 3200)

      // ===== ìƒíƒœ ì €ì¥ =====
      function persist() {
        localStorage.setItem(
          'seollem:state',
          JSON.stringify({
            volume: audio.volume,
            captionIndex,
          })
        )
      }
      audio.addEventListener('play', () => updateStatus('ì¬ìƒ ì¤‘'))
      audio.addEventListener('pause', () => updateStatus('ì¼ì‹œì •ì§€'))
      audio.addEventListener('ended', () => updateStatus('ì •ì§€ë¨'))
    </script>
  </body>
</html>
